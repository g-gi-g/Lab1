@model MarketplaceWebApplication.Data.Offer
@using Microsoft.AspNetCore.Http
@using MarketplaceWebApplication.Extensions
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Деталі";
    var userInfo = HttpContextAccessor.HttpContext.Session.GetObjectFromJson<UserDetails>("UserDetails");
}

<h1>Деталі</h1>

<div>
    <h4>пропозиції</h4>
    <hr />
    <dl class="row">
        <dt class = "col-sm-2">
            Назва
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Name)
        </dd>
        <dt class = "col-sm-2">
            Ціна(в грн)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Price)
        </dd>
        <dt class = "col-sm-2">
            Опис
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Description)
        </dd>
        <dt class = "col-sm-2">
            Фото
        </dt>
        @if (Model.Photo != null && Model.Photo.Length > 0)
        {
            string base64String = Convert.ToBase64String(Model.Photo);
            <dd class = "col-sm-10">
                <img src="data:image;base64,@base64String" alt="Photo" style="width:200px; height:auto;" />
            </dd>
        }
        else
        {
            <dd class="col-sm-10">
                Фото відсутнє
            </dd>
        }
        <dt class = "col-sm-2">
            Кількість замовлень
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.NumberOfOrders)
        </dd>
        <dt class = "col-sm-2">
            Час створення
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.TimeAdded)
        </dd>
        <dt class = "col-sm-2">
            Кількість товару
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.ItemAmount)
        </dd>
        <dt class = "col-sm-2">
            Категорія
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Category.Name)
        </dd>
        <dt class = "col-sm-2">
            Продавець
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Seller.Username)
        </dd>
    </dl>
</div>
<div>
    @if (userInfo is not null && Model.SellerId != userInfo.Id)
    {
        <a asp-controller="Orders" asp-action="Create" asp-route-id="@userInfo.Id" class="btn btn-primary" style="margin: 5px;">Замовити</a>
    }
    @if (userInfo is not null && Model.SellerId == userInfo.Id)
    {
        <a asp-action="Edit" asp-route-id="@Model?.Id" class="btn btn-primary" style="margin: 5px;">Редагувати</a>
    }
    <a asp-action="MainPageView" class="btn btn-primary" style="margin: 5px;">Назад</a>
</div>
